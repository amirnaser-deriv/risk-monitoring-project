<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Risk Monitoring Dashboard</title>
    <link rel="stylesheet" href="../shared/css/styles.css">
    <link rel="stylesheet" href="css/risk-dashboard.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <header>
        <nav>
            <h1>Risk Monitoring Dashboard</h1>
            <div id="user-info">
                <span id="username"></span>
                <button id="login-btn">Login</button>
                <button id="logout-btn" style="display: none;">Logout</button>
            </div>
        </nav>
    </header>

    <main class="dashboard-layout">
        <!-- Summary Cards -->
        <section class="summary-cards">
            <div class="metric-card total-positions">
                <h3>Total Open Positions</h3>
                <div class="metric-value" id="total-positions">0</div>
            </div>
            <div class="metric-card total-exposure">
                <h3>Total Exposure</h3>
                <div class="metric-value" id="total-exposure">$0</div>
            </div>
            <div class="metric-card daily-pnl">
                <h3>Daily P&L</h3>
                <div class="metric-value" id="daily-pnl">$0</div>
            </div>
            <div class="metric-card risk-level">
                <h3>Risk Level</h3>
                <div class="metric-value" id="risk-level">Low</div>
            </div>
        </section>

        <!-- Charts Section -->
        <section class="charts-grid">
            <div class="chart-container">
                <h2>Position Distribution</h2>
                <canvas id="position-distribution"></canvas>
            </div>
            <div class="chart-container">
                <h2>P&L Trend</h2>
                <canvas id="pnl-trend"></canvas>
            </div>
            <div class="chart-container">
                <h2>Risk Exposure</h2>
                <canvas id="risk-exposure"></canvas>
            </div>
            <div class="chart-container">
                <h2>Trading Volume</h2>
                <canvas id="trading-volume"></canvas>
            </div>
        </section>

        <!-- Active Alerts -->
        <section class="alerts-panel">
            <h2>Active Alerts</h2>
            <div class="alerts-list" id="alerts-list">
                <!-- Alerts will be dynamically added here -->
            </div>
        </section>

        <!-- Position Details -->
        <section class="positions-panel">
            <h2>Position Details</h2>
            <div class="positions-table-container">
                <table class="positions-table">
                    <thead>
                        <tr>
                            <th>Index</th>
                            <th>Side</th>
                            <th>Quantity</th>
                            <th>Entry Price</th>
                            <th>Current Price</th>
                            <th>P&L</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="positions-table-body">
                        <!-- Positions will be dynamically added here -->
                    </tbody>
                </table>
            </div>
        </section>
    </main>

    <!-- Load Supabase -->
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    
    <!-- Load application scripts -->
    <script src="../shared/js/supabase-client.js"></script>
    <script src="../shared/js/auth.js"></script>
    <script src="js/charts.js"></script>
    <script src="js/risk-dashboard.js"></script>

    <script>
        // Update loading status
        window.addEventListener('supabaseReady', () => {
            console.log('Supabase ready in dashboard');
        });

        window.addEventListener('authReady', () => {
            console.log('Auth ready in dashboard');
        });
    </script>
</body>
</html>
